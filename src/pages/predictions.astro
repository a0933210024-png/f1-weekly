---
import Layout from '../layouts/Layout.astro';
---

<Layout 
  title="AI 賽事預測 - Formula1 Weekly"
  description="每站賽前，我們用數據和 AI 分析誰最可能奪冠"
>
  <section class="predictions-page">
    <div class="container">
      <div class="predictions-header">
        <h1>🤖 AI 賽事預測</h1>
        <div class="red-line" style="margin: 1rem auto;"></div>
        <p class="subtitle">每站賽前，我們用數據和 AI 分析誰最可能奪冠</p>
      </div>

      <!-- 澳洲站預測 -->
      <div class="race-prediction">
        <div class="race-header">
          <h2>🏁 2026 澳洲大獎賽 - Melbourne</h2>
          <p class="race-date">3月8日 | Albert Park Circuit</p>
        </div>

        <!-- 冠軍預測 -->
        <div class="prediction-section">
          <h3>🏆 冠軍預測（信心指數）</h3>
          <div class="predictions-list">
            <div class="prediction-item">
              <div class="prediction-header-row">
                <span class="rank">1.</span>
                <span class="driver-name">Max Verstappen</span>
                <span class="team">(Red Bull)</span>
                <span class="percentage">34%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 34%; background: #0600ef;"></div>
              </div>
            </div>

            <div class="prediction-item">
              <div class="prediction-header-row">
                <span class="rank">2.</span>
                <span class="driver-name">Lewis Hamilton</span>
                <span class="team">(Ferrari)</span>
                <span class="percentage">28%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 28%; background: #dc0000;"></div>
              </div>
            </div>

            <div class="prediction-item">
              <div class="prediction-header-row">
                <span class="rank">3.</span>
                <span class="driver-name">Charles Leclerc</span>
                <span class="team">(Ferrari)</span>
                <span class="percentage">18%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 18%; background: #dc0000;"></div>
              </div>
            </div>

            <div class="prediction-item">
              <div class="prediction-header-row">
                <span class="rank">4.</span>
                <span class="driver-name">Lando Norris</span>
                <span class="team">(McLaren)</span>
                <span class="percentage">12%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 12%; background: #ff8700;"></div>
              </div>
            </div>

            <div class="prediction-item">
              <div class="prediction-header-row">
                <span class="rank">5.</span>
                <span class="driver-name">Others</span>
                <span class="team"></span>
                <span class="percentage">8%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 8%; background: #666;"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- AI 分析 -->
        <div class="analysis-section">
          <h3>🔍 AI 分析重點</h3>
          <div class="analysis-grid">
            <div class="analysis-card">
              <div class="analysis-icon">🏟️</div>
              <h4>賽道分析</h4>
              <p>Melbourne 街道賽，安全車機率高（歷史 85%），策略比純速度更重要</p>
            </div>

            <div class="analysis-card">
              <div class="analysis-icon">🔴</div>
              <h4>Ferrari 優勢</h4>
              <p>新引擎規則有利 Ferrari，Hamilton 動力加持，開幕戰情緒高漲</p>
            </div>

            <div class="analysis-card">
              <div class="analysis-icon">🔵</div>
              <h4>Red Bull 風險</h4>
              <p>Ford 引擎首戰，可靠性未知，Verstappen 需要穩定完賽</p>
            </div>

            <div class="analysis-card">
              <div class="analysis-icon">🟠</div>
              <h4>McLaren 黑馬</h4>
              <p>Norris 近年 Melbourne 表現穩定，是最大驚喜候選</p>
            </div>

            <div class="analysis-card">
              <div class="analysis-icon">⚠️</div>
              <h4>變數</h4>
              <p>新車首站機械故障率歷史高，規則大改年開幕戰混亂是常態</p>
            </div>
          </div>
        </div>

        <!-- 預測方法論 -->
        <div class="methodology">
          <h3>📊 預測方法論</h3>
          <p>本預測基於以下數據：</p>
          <ul>
            <li>季前測試圈速（巴林 2026）</li>
            <li>各車隊近 3 年 Melbourne 歷史表現</li>
            <li>2026 新規對各引擎方案的影響評估</li>
            <li>車手近期狀態評分</li>
            <li>天氣預報（雨天機率影響排位）</li>
          </ul>
          <p><strong>更新頻率：</strong>每站賽前 72 小時重新計算</p>
        </div>

        <!-- 車手狀態燈號卡 -->
        <section class="prediction-enhancements">
          <h3>🚦 車手狀態評估</h3>
          <div class="driver-status-grid">
            <div class="status-card" style="--team-color: #0600EF;">
              <div class="status-badge">🔥 熱手中</div>
              <h4>Verstappen</h4>
              <p class="team">Red Bull Racing</p>
              <p class="comment">衛冕冠軍氣勢如虹，澳洲站依舊是頭號威脅。</p>
            </div>
            <div class="status-card" style="--team-color: #DC0000;">
              <div class="status-badge">🔥 熱手中</div>
              <h4>Hamilton</h4>
              <p class="team">Ferrari</p>
              <p class="comment">加盟法拉利首戰熱度破表，模擬賽數據驚人。</p>
            </div>
            <div class="status-card" style="--team-color: #DC0000;">
              <div class="status-badge">✅ 穩定</div>
              <h4>Leclerc</h4>
              <p class="team">Ferrari</p>
              <p class="comment">這條賽道一向適合他的駕駛風格，期待站上頒獎台。</p>
            </div>
            <div class="status-card" style="--team-color: #FF8700;">
              <div class="status-badge">✅ 穩定</div>
              <h4>Norris</h4>
              <p class="team">McLaren</p>
              <p class="comment">麥拉倫升級套件穩定，正賽速度具有競爭力。</p>
            </div>
            <div class="status-card" style="--team-color: #00D2BE;">
              <div class="status-badge">⚠️ 需觀察</div>
              <h4>Russell</h4>
              <p class="team">Mercedes</p>
              <p class="comment">測試賽遇到些許平衡難題，需在排位賽後觀察。</p>
            </div>
          </div>

          <!-- 賽道難度評分卡 -->
          <div class="track-info-card">
            <h3>🏟️ Albert Park 賽道特性分析</h3>
            <div class="stat-row">
              <span>超車難度</span>
              <div class="bar-bg"><div class="bar-fill" style="width: 70%;"></div></div>
              <span class="score">7/10</span>
            </div>
            <div class="stat-row">
              <span>安全車機率</span>
              <div class="bar-bg"><div class="bar-fill" style="width: 90%;"></div></div>
              <span class="score">9/10</span>
            </div>
            <div class="stat-row">
              <span>輪胎磨損</span>
              <div class="bar-bg"><div class="bar-fill" style="width: 60%;"></div></div>
              <span class="score">6/10</span>
            </div>
            <div class="stat-row">
              <span>天氣影響</span>
              <div class="bar-bg"><div class="bar-fill" style="width: 70%;"></div></div>
              <span class="score">7/10</span>
            </div>
          </div>

          <!-- 互動投票 -->
          <div class="vote-section">
            <h3>🗳️ 你猜誰奪下澳洲站冠軍？</h3>
            <div class="vote-options">
              <button onclick="castVote('Verstappen')">Verstappen</button>
              <button onclick="castVote('Hamilton')">Hamilton</button>
              <button onclick="castVote('Leclerc')">Leclerc</button>
              <button onclick="castVote('Norris')">Norris</button>
              <button onclick="castVote('黑馬')">🎲 黑馬</button>
            </div>
            <div id="vote-results" class="vote-results hidden"></div>
          </div>
        </section>

        <!-- 免責聲明 -->
        <div class="disclaimer">
          <p>⚠️ <strong>免責聲明：</strong>以上為 AI 根據歷史數據的分析，F1 結果無法預測——這正是我們愛看的原因 🏁</p>
        </div>

        <!-- 下一站預告 -->
        <div class="next-race">
          <p>📅 <strong>下一站預測：</strong>中國站預測將於 3/10 發布</p>
        </div>
      </div>
    </div>
  </section>
</Layout>

<script is:inline>
  function castVote(driver) {
    let votes = JSON.parse(localStorage.getItem('f1_votes_aus2026') || '{}');
    if (!votes[driver]) votes[driver] = 0;
    votes[driver]++;
    localStorage.setItem('f1_votes_aus2026', JSON.stringify(votes));

    const container = document.getElementById('vote-results');
    container.classList.remove('hidden');
    const total = Object.values(votes).reduce((a, b) => a + b, 0);
    container.innerHTML = '<h4>即時票數</h4>' + 
      Object.entries(votes)
        .sort((a, b) => b[1] - a[1])
        .map(([k, v]) => `<div class="vote-row"><span>${k}</span><div class="vote-bar-bg"><div class="vote-bar-fill" style="width:${Math.round(v/total*100)}%"></div></div><span>${v} 票 (${Math.round(v/total*100)}%)</span></div>`)
        .join('');
  }
</script>

<style>
  .predictions-page {
    padding: var(--spacing-2xl) 0;
    min-height: 70vh;
  }
  
  .predictions-header {
    text-align: center;
    max-width: 800px;
    margin: 0 auto var(--spacing-2xl);
  }

  .predictions-header h1 {
    font-size: 2.5rem;
    margin-bottom: var(--spacing-md);
  }
  
  .subtitle {
    font-size: 1.25rem;
    color: #aaa;
    margin-top: var(--spacing-lg);
  }

  .race-prediction {
    max-width: 900px;
    margin: 0 auto;
    background: var(--bg-card);
    padding: var(--spacing-2xl);
    border-radius: 12px;
    border: 2px solid #222;
  }

  .race-header {
    text-align: center;
    margin-bottom: var(--spacing-2xl);
  }

  .race-header h2 {
    color: var(--f1-red);
    font-size: 2rem;
    margin-bottom: var(--spacing-sm);
  }

  .race-date {
    color: #888;
    font-size: 1.125rem;
  }

  .prediction-section {
    margin-bottom: var(--spacing-2xl);
  }

  .prediction-section h3 {
    color: var(--text-primary);
    margin-bottom: var(--spacing-lg);
    font-size: 1.5rem;
  }

  .predictions-list {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
  }

  .prediction-item {
    background: #111;
    padding: var(--spacing-md);
    border-radius: 8px;
    border: 1px solid #333;
  }

  .prediction-header-row {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-sm);
  }

  .rank {
    color: var(--f1-red);
    font-weight: bold;
    font-size: 1.125rem;
    min-width: 30px;
  }

  .driver-name {
    color: var(--text-primary);
    font-weight: bold;
    flex: 1;
  }

  .team {
    color: #888;
  }

  .percentage {
    color: var(--f1-red);
    font-weight: bold;
    font-size: 1.125rem;
    min-width: 50px;
    text-align: right;
  }

  .progress-bar {
    width: 100%;
    height: 24px;
    background: #222;
    border-radius: 4px;
    overflow: hidden;
  }

  .progress-fill {
    height: 100%;
    transition: width 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding-right: 8px;
  }

  .analysis-section {
    margin-bottom: var(--spacing-2xl);
  }

  .analysis-section h3 {
    color: var(--text-primary);
    margin-bottom: var(--spacing-lg);
    font-size: 1.5rem;
  }

  .analysis-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--spacing-md);
  }

  .analysis-card {
    background: #111;
    padding: var(--spacing-lg);
    border-radius: 8px;
    border: 1px solid #333;
    transition: border-color 0.3s ease;
  }

  .analysis-card:hover {
    border-color: var(--f1-red);
  }

  .analysis-icon {
    font-size: 2rem;
    margin-bottom: var(--spacing-sm);
  }

  .analysis-card h4 {
    color: var(--f1-red);
    margin-bottom: var(--spacing-sm);
    font-size: 1.125rem;
  }

  .analysis-card p {
    color: #aaa;
    line-height: 1.6;
  }

  .methodology {
    background: #111;
    padding: var(--spacing-lg);
    border-radius: 8px;
    border: 1px solid #333;
    margin-bottom: var(--spacing-lg);
  }

  .methodology h3 {
    color: var(--f1-red);
    margin-bottom: var(--spacing-md);
    font-size: 1.25rem;
  }

  .methodology p {
    color: #aaa;
    margin-bottom: var(--spacing-sm);
    line-height: 1.6;
  }

  .methodology ul {
    list-style: none;
    padding: 0;
    margin: var(--spacing-md) 0;
  }

  .methodology li {
    color: #ddd;
    padding: var(--spacing-xs) 0;
    padding-left: var(--spacing-md);
    position: relative;
    line-height: 1.6;
  }

  .methodology li::before {
    content: "•";
    color: var(--f1-red);
    font-weight: bold;
    position: absolute;
    left: 0;
  }

  .disclaimer {
    background: #1a1a1a;
    padding: var(--spacing-lg);
    border-radius: 8px;
    border-left: 4px solid var(--f1-red);
    margin-bottom: var(--spacing-lg);
  }

  .disclaimer p {
    color: #ddd;
    margin: 0;
    line-height: 1.6;
  }

  .next-race {
    text-align: center;
    padding: var(--spacing-lg);
    background: #111;
    border-radius: 8px;
    border: 1px solid #333;
  }

  .next-race p {
    color: #aaa;
    margin: 0;
    font-size: 1.125rem;
  }

  @media (max-width: 768px) {
    .predictions-header h1 { font-size: 2rem; }
    .race-header h2 { font-size: 1.5rem; }
    .analysis-grid { grid-template-columns: 1fr; }
    .prediction-header-row { flex-wrap: wrap; }
    .team { width: 100%; margin-left: 30px; }
    .driver-status-grid { grid-template-columns: 1fr 1fr; }
  }

  /* ===== Jisoo Enhancement Styles ===== */
  .prediction-enhancements { margin-top: var(--spacing-2xl); }
  .prediction-enhancements h3 { font-size: 1.5rem; margin-bottom: var(--spacing-lg); color: var(--text-primary); }

  .driver-status-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; margin-bottom: var(--spacing-xl); }
  .status-card { background: #111; padding: 14px; border-radius: 10px; border-left: 4px solid var(--team-color); transition: transform 0.2s; }
  .status-card:hover { transform: translateY(-4px); }
  .status-badge { font-size: 0.75rem; background: #222; display: inline-block; padding: 2px 8px; border-radius: 4px; margin-bottom: 8px; }
  .status-card h4 { margin: 4px 0; color: #fff; font-size: 1rem; }
  .status-card .team { font-size: 0.75rem; opacity: 0.6; margin-bottom: 8px; }
  .status-card .comment { font-size: 0.82rem; line-height: 1.4; color: #ccc; margin: 0; }

  .track-info-card { background: #111; padding: var(--spacing-lg); border-radius: 12px; margin-bottom: var(--spacing-xl); }
  .track-info-card h3 { font-size: 1.25rem; margin-bottom: var(--spacing-md); }
  .stat-row { display: flex; align-items: center; margin-bottom: 12px; gap: 14px; }
  .stat-row > span:first-child { width: 110px; font-size: 0.9rem; color: #ccc; }
  .bar-bg { flex-grow: 1; height: 8px; background: #333; border-radius: 4px; overflow: hidden; }
  .bar-fill { height: 100%; background: linear-gradient(90deg, #dc0000, #ff8700); border-radius: 4px; }
  .score { width: 45px !important; text-align: right; color: var(--f1-red); font-weight: bold; font-size: 0.9rem; }

  .vote-section { background: #111; padding: var(--spacing-lg); border-radius: 12px; text-align: center; }
  .vote-section h3 { font-size: 1.25rem; margin-bottom: var(--spacing-md); }
  .vote-options { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-top: var(--spacing-md); }
  .vote-options button { background: transparent; border: 1px solid var(--f1-red); color: white; padding: 8px 18px; border-radius: 20px; cursor: pointer; transition: 0.2s; font-size: 0.9rem; }
  .vote-options button:hover { background: var(--f1-red); box-shadow: 0 0 12px rgba(220,0,0,0.5); }
  .vote-results { margin-top: var(--spacing-md); padding: var(--spacing-md); border-top: 1px solid #333; }
  .vote-results h4 { margin-bottom: var(--spacing-sm); }
  .vote-row { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; font-size: 0.85rem; }
  .vote-row > span:first-child { width: 100px; text-align: left; }
  .vote-bar-bg { flex-grow: 1; height: 6px; background: #333; border-radius: 3px; overflow: hidden; }
  .vote-bar-fill { height: 100%; background: var(--f1-red); border-radius: 3px; transition: width 0.4s ease; }
  .vote-row > span:last-child { width: 90px; text-align: right; color: #aaa; }
  .hidden { display: none !important; }
</style>
